---
sidebar: sidebar 
permalink: task-scanning-file-shares.html 
keywords: cloud compliance, enable cloud compliance, privacy, compliance, file shares, nfs, cifs, smb, data sense, 7-mode 
summary: 完成几个步骤即可开始使用数据分类直接扫描非NetApp NFS 或 CIFS 文件共享。这些文件共享可以驻留在本地或云端。 
---
= 使用NetApp数据分类扫描文件共享
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
要扫描文件共享，您必须首先在NetApp数据分类中创建一个文件共享组。文件共享组适用于本地或云中托管的 NFS 或 CIFS (SMB) 共享。


NOTE: 数据分类核心版本不支持扫描非NetApp文件共享的数据。



== 前提条件

在启用数据分类之前，请查看以下先决条件，以确保您具有受支持的配置。

* 共享可以托管在任何地方，包括云端或本地。可以将旧版NetApp 7-模式存储系统中的 CIFS 共享扫描为文件共享。
+
** 数据分类无法从 7 模式系统中提取权限或“上次访问时间”。
** 由于某些 Linux 版本和 7-模式系统上的 CIFS 共享之间存在已知问题，因此您必须将共享配置为仅使用启用了 NTLM 身份验证的 SMBv1。


* 数据分类实例和共享之间需要有网络连接。
* 您可以将 DFS（分布式文件系统）共享添加为常规 CIFS 共享。由于数据分类不知道共享是基于组合为单个 CIFS 共享的多个服务器/卷构建的，因此当消息实际上仅适用于位于不同服务器/卷上的一个文件夹/共享时，您可能会收到有关共享的权限或连接错误。
* 对于 CIFS (SMB) 共享，请确保您拥有可提供共享读取访问权限的 Active Directory 凭据。如果数据分类需要扫描任何需要提升权限的数据，则最好使用管理员凭据。
+
如果您想确保文件的“上次访问时间”不会因数据分类扫描而改变，建议用户在 CIFS 中具有写入属性权限或在 NFS 中具有写入权限。如果可能，请将 Active Directory 用户配置为组织中具有所有文件权限的父组的一部分。

* 组中的所有 CIFS 文件共享必须使用相同的 Active Directory 凭据。
* 您可以混合使用 NFS 和 CIFS（使用 Kerberos 或 NTLM）共享。您必须单独将共享添加到组中。也就是说，您必须完成该过程两次 - 每个协议一次。
+
** 您不能创建混合 CIFS 身份验证类型（Kerberos 和 NTLM）的文件共享组。


* 如果您使用带有 Kerberos 身份验证的 CIFS，请确保数据分类可以访问所提供的 IP 地址。如果 IP 地址无法访问，则无法添加文件共享。




== 创建文件共享组

将文件共享添加到组时，必须使用格式 `<host_name>:/<share_path>`。

您可以单独添加文件共享，也可以输入要扫描的文件共享的行分隔列表。您一次最多可以添加 100 股。

.步骤
. 从数据分类菜单中，选择*配置*。
. 从配置页面中，选择*添加系统*>*添加文件共享组*。
. 在添加文件共享组对话框中，输入共享组的名称，然后选择*继续*。
. 选择要添加的文件共享的协议。
+
image:screen-cl-config-shares-add.png["添加共享模式的屏幕截图，显示了选择协议和共享的选项"]

+
.. 如果您要添加具有 NTLM 身份验证的 CIFS 共享，请输入 Active Directory 凭据以访问 CIFS 卷。尽管支持只读凭据，但建议您使用管理员凭据提供完全访问权限。选择**保存**。


. 添加要扫描的文件共享（每行一个文件共享）。然后选择**继续**。
. 确认对话框显示已添加的共享数量。
+
如果对话框列出了任何无法添加的共享，请捕获此信息以便解决问题。如果问题与命名约定有关，您可以使用更正的名称重新添加共享。

. 配置卷上的扫描：
+
** 要对文件共享启用仅映射扫描，请选择*映射*。
** 要对文件共享启用完整扫描，请选择*Map & Classify*。
** 要禁用文件共享上的扫描，请选择“*关闭*”。
+

NOTE: 页面顶部的“缺少“写入属性”权限时扫描”开关默认处于禁用状态。这意味着，如果数据分类在 CIFS 中没有写属性权限或在 NFS 中没有写权限，系统将不会扫描文件，因为数据分类无法将“上次访问时间”恢复为原始时间戳。  + 如果将*缺少“写入属性”权限时扫描*切换为*开*，则扫描将重置上次访问时间并扫描所有文件，而不管权限如何。  + 要了解有关上次访问时间戳的更多信息，请参阅link:link:reference-collected-metadata.html#last-access-time-timestamp["从数据分类中的数据源收集的元数据"]。





.结果
数据分类开始扫描您添加的文件共享中的文件。你可以xref:#track-the-scanning-progress[跟踪扫描进度]并在**仪表板**中查看扫描结果。


NOTE: 如果对于使用 Kerberos 身份验证的 CIFS 配置的扫描未成功完成，请检查**配置**选项卡中是否存在错误。



== 编辑文件共享组

创建文件共享组后，您可以编辑 CIFS 协议或添加和删除文件共享。

.编辑 CIFS 协议配置
. 从数据分类菜单中，选择*配置*。
. 从配置页面中，选择要修改的文件共享组。
. 选择**编辑 CIFS 凭证**。
+
image:screenshot-edit-cifs-credential.png["编辑 CIFS 凭证菜单的屏幕截图。"]

. 选择身份验证方法：**NTLM** 或 **Kerberos**。
. 输入 Active Directory **用户名**和**密码**。
. 选择**保存**以完成该过程。


.将文件共享添加到合规性扫描
. 从数据分类菜单中，选择*配置*。
. 从配置页面中，选择要修改的文件共享组。
. 选择 **+ 添加共享**。
. 选择要添加的文件共享的协议。
+
image:screen-cl-config-shares-add.png["添加共享模式的屏幕截图，显示了选择协议和共享的选项"]

+
如果您要将文件共享添加到已配置的协议，则无需进行任何更改。

+
如果您要使用第二种协议添加文件共享，请确保您已正确配置身份验证，如link:#prerequisites["前提条件"]。

. 使用以下格式添加要扫描的文件共享（每行一个文件共享） `<host_name>:/<share_path>` 。
. 选择**继续**以完成添加文件共享。


.从合规性扫描中删除文件共享
. 从数据分类菜单中，选择*配置*。
. 选择要从中删除文件共享的系统。
. 选择*配置*。
. 在配置页面中，选择操作image:button-actions-horizontal.png["操作图标"]对于要删除的文件共享。
. 从操作菜单中，选择*删除共享*。




== 跟踪扫描进度

您可以跟踪初始扫描的进度。

. 选择**配置**菜单。
. 选择**系统配置**。
. 对于存储库，检查扫描进度列以查看其状态。

